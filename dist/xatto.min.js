!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(n.xatto={})}(this,function(n){"use strict";var g="xa.context",s="xa.extra",p="xa.fill",y="xa.path",d="xa.slice",h="xa.text",x="middlewares",b="children",v="key",w="name",k="props";function E(n,e){for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n}var A="element",j="lifecycle",N="prev."+k,O="create",P="destroy",R="remove",C="removing",L="update";function S(n,e,r,t){for(void 0===t&&(t=".");;){if("object"!=typeof n)return!1;var u=e.indexOf(t);if(u<0)return n[e]=r,!0;var i=e.slice(0,u),o=e.slice(u+1);if(null==n[i]){var c=o.split(t,1)[0];n[i]=c===""+parseInt(c,10)?[]:{}}n=n[i],e=o}}function T(n){var e=E({},n);return e.i=0,e[j]=O,e[b]=n[b].map(function(n){return T(n)}),S(e,N,{}),e}var B="xa-txt";function H(n,e,r,t){void 0===r&&(r={}),void 0===t&&(t=[]);var u={};return u[w]=e,u[k]=r,u[b]=t,u[v]=r.key,n&&"function"!=typeof e&&(u[w]=B,S(u[k],h,e)),u}function I(n,e,r){for(void 0===r&&(r=".");;){if(null==n)return n;var t=e.indexOf(r);if(t<0)return n[e];n=n[e.slice(0,t)],e=e.slice(t+1)}}function M(n,e,r,t){return S(n,g,e||I(n,g)||{}),S(n,s,r||I(n,s)||{}),S(n,y,t||""),n}function V(u,i){return function(){for(var n,e,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return n=u,e=i.concat(r),n.apply(null,e)}}var m="http://www.w3.org/1999/xlink";function W(n,e,r,t,u,i,o){if("key"===e||"object"==typeof r);else if("o"===e[0]&&"n"===e[1]){var c=e.slice(2);null==r?n.removeEventListener(c,i):null==t&&n.addEventListener(c,i)}else{var a=null==r||!1===r;if(e in n&&"list"!==e&&"draggable"!==e&&"spellcheck"!==e&&"translate"!==e&&!u)a?n.removeAttribute(e):n[e]=null==r?"":r;else{var f=!1;if(u){var l=e;f=(e=e.replace(/^xlink:?/,""))!==l}switch((a?1:0)+((f?1:0)<<1)){case 0:n.setAttribute(e,r);break;case 1:n.removeAttribute(e);break;case 2:n.setAttributeNS(m,e,r);break;case 3:n.removeAttributeNS(m,e)}}}}function q(n,e,r,t,u,i,o,c,a,f){var l,v=i[A];o||"svg"!==i[w]||(o=!0),f||i[j]!==P||(f=!0);var s,p=f?P:i[j],d=null;switch(p){case O:v=function(n,e,r,t){var u=n[k]||{};if(n[w]===B)return document.createTextNode(I(u,h));var i=(e=e||"svg"===n[w])?document.createElementNS("http://www.w3.org/2000/svg",n[w]):document.createElement(n[w]);for(var o in u)W(i,o,u[o],null,e,r);return t.set(i,u),i}(i,o,c,a);break;case L:l=function(n,e,r,t){var u=n[A],i=n[k],o=I(n,N)||{},c=!1;if(n[w]===B)return(c=I(i,h)!=I(o,h))&&(u.nodeValue=I(i,h)),[u,c];for(var a in i)i[a]!==("value"===a||"checked"===a?u[a]:o[a])&&(W(u,a,i[a],o[a],e,r),c=!0);return t.set(u,i),[u,c]}(i,o,c,a),v=l[0],s=l[1];break;case P:i[j]===P&&e.push(function(){return v.parentElement.removeChild(v)});break;case R:i[j]=C,d={done:function(){i[j]=P,Promise.resolve({}).then(n)}}}switch(p){case O:case P:case R:s=!0}s&&v instanceof Element&&r.push(function(n,e,r){void 0===r&&(r={});var t=new CustomEvent(e,r);return function(){return n.dispatchEvent(t)}}(v,p.toLowerCase(),{detail:d}));var m=i[b].reduce(function(n,e){var r=u(e,o,c,a,f);return r?n.concat(r):n},[]);return p===P?null:(m.map(function(n){return n.element}).reduceRight(function(n,e){return v.insertBefore(e,n),e},null),i[b]=m,i[A]=v,i)}function z(n){return null!=n&&"object"==typeof n&&k in n&&b in n&&v in n&&w in n&&4===Object.keys(n).length}function D(n,e){for(var r=[],t=2;t<arguments.length;t++)r[t-2]=arguments[t];for(var u=[];r.length;){var i=r.pop();i&&Array.isArray(i)?r=r.concat(i):null!=i&&!0!==i&&!1!==i&&u.unshift(z(i)&&i||H(!0,i))}return H(!1,n,e||{},u)}function F(n,r,t,e,u){return e.reduce(function(n,e){return n.push.apply(n,r(t,e,u)),n},[])}function G(n,r,t,e,u){if(!e)return[];if(D===e.name)return F(0,r,t,e[b],u);var i=e[k],o=u&&u[k]||{},c=I(i,y);if(!c){var a=I(o,y)||"",f=I(i,d);c=a&&f?a+"."+f:f||a}var l=c?I(t,c):t;l||(l=E({},I(i,p)||{}),S(t,c,l));var v=M(i,l,E(E({},I(i,s)||{}),u&&I(u,k+"."+s)||{}),c);return("function"==typeof e.name?r(t,e.name(v,e[b]),e):[e]).reduce(function(n,e){return z(e)&&(e[b]=F(0,r,t,e[b],e),n.push(e)),n},[])}var J=function(n){return k+".on"+n};function K(n,e,r,t,u,i){var o=M(n[k]),c=i.map(function(n){return n[0]}).reduce(Q,[U,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return c.apply(null,n)}])[0],a=i.map(function(n){return n[1]}).reduce(Q,[U,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return a.apply(null,n)}])[0],f=i.map(function(n){return n[2]}).reduce(Q,[U,U])[0],l=function u(n,e){if(!e)return T(n);if(!n)return S(e,N,e[k]),e[j]=e[j]===C||e[j]===P?e[j]:I(e,J(R))?R:P,e;S(e,N,e[k]),e[k]=n[k],e[v]=n[v],e[w]=n[w],e[j]=L;var i=e[b].map(function(n,e){return n.i=e,n}),o=n[b].map(function(n){var e,r,t;for(t=0;t<i.length;t++)if(r=i[t],n[w]==r[w]&&n[v]==r[v]&&(L===r[j]||O===r[j])){e=r;break}return e?(i.splice(t,1),u(n,e)):u(n)});return i.reduceRight(function(n,e){if(0===(e=u(void 0,e)).i)o.unshift(e);else{var r=e.i-1,t=void 0;for(t=0;t<o.length;t++)if(r===o[t].i)return o.splice(t+1,0,e),0;o.push(e)}return 0},0),e[b]=o,e}(c(r,D(e,o,[]))[0],n);return n=a(l,"svg"===l.name,t,u,!1),f(),n}function Q(n,e){var r=n[0],t=n[1];return[e?e(r,t):r,t]}function U(){}n.atto=function(e,n,r){void 0===r&&(r={});var t,u,i=!1,o=n instanceof Element?((u=T(H(!1,(t=n).nodeName)))[A]=t,u):n,c=I(M(o[k]),g),a=new WeakMap,f=x in r&&r[x]||[],l=[function(u){return function(){var r=[],t=[];return[function(n,e){return V(G,[n,e])},function(n,e){return V(q,[u,r,t,n,e])},function(n){return function(){t.reduceRight(function(n,e){return e()},0),r.reduceRight(function(n,e){return e()},0),n()}}]}}].concat(f).map(function(n){return n(v,a,c,e,o)});function v(n,e){if(void 0===e&&(e=""),n){if(n instanceof Promise)return n.then(function(n){return v(n,e)});if("function"==typeof n)return n(v,c);if("object"==typeof n){var r=s(e||"");if(n===r)return;var t=E(E({},r),n);e?S(c,e,t):c=t,i||(i=!0,Promise.resolve().then(d).then(m,h))}}}function s(n,e){return void 0===e&&(e={}),(n?I(c,n):c)||e}function p(n){var e=n.currentTarget,r=a.get(e),t=I(r,y);v(r["on"+n.type](s(t),r,n),t)}function d(){o=K(o,e,c,p,a,l.map(function(n){return n(c)}))}function m(){i=!1}function h(n){throw m(),n}return v},n.currentOnlyEventHandler=function(t){return function(n,e,r){if(r.currentTarget===r.target)return t(n,e,r)}},n.x=D});
//# sourceMappingURL=xatto.min.js.map