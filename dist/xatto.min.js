!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.xatto={})}(this,function(e){"use strict";var j="attributes",w="children",O="xa-context",k="xa-extra",N="xa-recycle",u="xa-slice";function d(e,n,t){for(void 0===t&&(t=".");;){if(null==e)return e;var r=n.indexOf(t);if(r<0)return e[n];e=e[n.slice(0,r)],n=n.slice(r+1)}}function p(e,n,t,r){for(void 0===r&&(r=".");;){if("object"!=typeof e)return!1;var o=n.indexOf(r);if(o<0)return e[n]=t,!0;var i=n.slice(0,o),a=n.slice(o+1);if(null==e[i]){var l=a.split(r,1)[0];e[i]=l===""+parseInt(l,10)?[]:{}}e=e[i],n=a}}var A=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e};function E(e,n){var t=e&&e[j];if(t){var r=t[O]||n&&n[j]&&n[j][O]||{},o=t[u],i=void 0;"object"!=typeof o&&(o=[o]);var a=o[0];if(a){if(!(i=d(r,a))){var l=o[1]||{};p(r,a,i=A({},l))}r=i}var f=A({},t[k]||{},n&&n[j]&&n[j][k]||{});t[O]=r,t[k]=f}return e&&"function"==typeof e.name?E(e.name(e[j],e[w]),e):null!=e?e:""}function P(e,n,t,r,o,i){"key"===n||"object"==typeof t||("o"===n[0]&&"n"===n[1]?(e.events||(e.events={}),(e.events[n=n.slice(2)]=t)?r||e.addEventListener(n,i):e.removeEventListener(n,i)):n in e&&"list"!==n&&!o?e[n]=null==t?"":t:null!=t&&!1!==t&&e.setAttribute(n,t),null!=t&&!1!==t||e.removeAttribute(n))}function B(e){return e?e.key:null}function C(e,n,t){function r(){e.removeChild(function e(n,t){var r=t[j];if(r){for(var o=0;o<t[w].length;o++)e(n.childNodes[o],t[w][o]);r.ondestroy&&r.ondestroy(n,r,r[O],r[k])}return n}(n,t))}var o=t[j]||{},i=o.onremove;i?i(n,r,o,o[O],o[k]):r()}function L(e,n,t,r,o,i,a){if(void 0===i&&(i=!1),r===t);else if(null==t||t.name!==r.name){var l=function e(n,t,r,o){var i="string"==typeof n||"number"==typeof n?document.createTextNode(n):(r=r||"svg"===n.name)?document.createElementNS("http://www.w3.org/2000/svg",n.name):document.createElement(n.name),a=n[j];if(a){var l=a.oncreate;l&&t.push(function(){l(i,{},a[O],a[k])});for(var f=0;f<n[w].length;f++)i.appendChild(e(n[w][f]=E(n[w][f],n),t,r,o));for(var u in a)P(i,u,a[u],null,r,o);i.context=a[O],i.extra=a[k]}return i}(r,o,i,a);e.insertBefore(l,n),null!=t&&C(e,n,t),n=l}else if(null==t.name)n.nodeValue=r;else{!function(e,n,t,r,o,i){var a=A({},n,t);for(var l in a)t[l]!==("value"===l||"checked"===l?e[l]:n[l])&&P(e,l,t[l],n[l],o,i);e.context=t[O],e.extra=t[k];var f=t[N]?t.oncreate:t.onupdate;f&&r.push(function(){f(e,n,t[O],t[k])})}(n,t[j],r[j],o,i=i||"svg"===r.name,a);for(var f={},u={},c=[],v=t[w],s=r[w],d=0;d<v.length;d++){c[d]=n.childNodes[d],null!=(m=B(v[d]))&&(f[m]=[c[d],v[d]])}for(var p=0,h=0;h<s.length;){var m=B(v[p]),x=B(s[h]=E(s[h],r));if(u[m])p++;else if(null==x||x!==B(v[p+1])){var y=(s[h][j]||{})[N];if(null==x||!0===y)null==m&&(L(n,c[p],v[p],s[h],o,i,a),h++),p++;else{var g=f[x]||[];m===x?(L(n,g[0],g[1],s[h],o,i,a),p++):g[0]?L(n,n.insertBefore(g[0],c[p]),g[1],s[h],o,i,a):L(n,c[p],null,s[h],o,i,a),u[x]=s[h],h++}}else null==m&&C(n,c[p],v[p]),p++}for(;p<v.length;)null==B(v[p])&&C(n,c[p],v[p]),p++;for(var b in f)u[b]||C(n,f[b][0],f[b][1])}return n}function h(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];for(var o=[];t.length;){var i=t.pop();i&&Array.isArray(i)?t=t.concat(i):null!=i&&!0!==i&&!1!==i&&o.unshift(i)}return{name:e,attributes:n||{},children:o,key:n&&n.key}}e.atto=function(t,r,o){void 0===o&&(o=null);var i=!1,a=o&&o[j]||{},l=a[O]={};function f(e,n,t){if(void 0===n&&(n=l),void 0===t&&(t=null),e&&e!==n)if(e instanceof Promise)e.then(function(e){return f(e,n,t)});else if("object"==typeof e){null==t&&"string"==typeof n&&(t=n,n=l);var r=t?d(n,t)||{}:n;Object.entries(e).map(function(e){var n=e[0],t=e[1];return r[n]=t}),t&&p(n,t,r)}i||(i=!0,Promise.resolve().then(c).then(v,s))}function u(e){var n=e.currentTarget;n.context=n.context||{},n.extra=n.extra||{},f(n.events[e.type](e,n.context,n.extra),n.context)}function c(){var e=[],n=E(h(t,a,o&&o[w]),h("div",{},[]));for(r=L(r.parentNode,r,o,o=n,e,"svg"===n.name,u),a[N]=!1;e.length;)e.pop()()}function v(){i=!1}function s(e){throw v(),e}return f},e.x=h});
//# sourceMappingURL=dist/xatto.min.js.map