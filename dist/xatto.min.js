!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(n.xatto={})}(this,function(n){"use strict";var x="xa.context",p="xa.extra",d="xa.fill",m="xa.path",h="xa.slice",w="xa.text",b="middlewares",k="children",c="key",E="name",A="props",j="element",N="lifecycle",O="prev."+A,P="create",C="destroy",L="remove",M="removing",R="update";function S(n,e){for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function T(n,e,t,r){for(void 0===r&&(r=".");;){if("object"!=typeof n)return!1;var u=e.indexOf(r);if(u<0)return n[e]=t,!0;var i=e.slice(0,u),o=e.slice(u+1);if(null==n[i]){var a=o.split(r,1)[0];n[i]=a===""+parseInt(a,10)?[]:{}}n=n[i],e=o}}function W(n){var e=S({},n);return e.i=0,e[N]=P,e[k]=n[k].map(function(n){return W(n)}),T(e,O,{}),e}var F="xa-txt";function B(n,e,t,r){void 0===t&&(t={}),void 0===r&&(r=[]);var u={};return u[E]=e,u[A]=t,u[k]=r,u[c]=t.key,n&&"function"!=typeof e&&(u[E]=F,T(u[A],w,e)),u}function H(n,e,t){for(void 0===t&&(t=".");;){if(null==n)return n;var r=e.indexOf(t);if(r<0)return n[e];n=n[e.slice(0,r)],e=e.slice(r+1)}}function I(e,t,n,r,u){if(void 0===u&&(u=""),r){if(r instanceof Promise)return r.then(function(n){return I(e,t,n,u)});if("function"==typeof r)return r(I,e);if("object"==typeof r){var i=e(u);if(r===i)return;var o=S(S({},i),r);t(o,u),n()}}}function V(n,e,t,r){return T(n,x,e||H(n,x)||{}),T(n,p,t||H(n,p)||{}),T(n,m,r||""),n}var l="http://www.w3.org/1999/xlink";function q(n,e,t,r,u,i){if("object"==typeof t);else if("o"===e[0]&&"n"===e[1]){var o=e.slice(2);t instanceof Function?n.removeEventListener(o,i):r instanceof Function&&n.addEventListener(o,i)}else{var a=null==t||!1===t;if(e in n&&"list"!==e&&"draggable"!==e&&"spellcheck"!==e&&"translate"!==e&&!u)a?n.removeAttribute(e):n[e]=null==t?"":t;else{var c=!1;if(u){var f=e;c=(e=e.replace(/^xlink:?/,""))!==f}switch((a?1:0)+((c?1:0)<<1)){case 0:n.setAttribute(e,t);break;case 1:n.removeAttribute(e);break;case 2:n.setAttributeNS(l,e,t);break;case 3:n.removeAttributeNS(l,e)}}}}var z={};function g(n,e,t,r,u,i,o,a,c,f,l){var v,s=S({},c),p=c[j];f||"svg"!==c[E]||(f=!0);var d=c[N];d===M&&p instanceof Element&&i.has(p)&&(d=C);var m,h=z[d],g=z[l],y=g&&(!h||h<g)&&l||d,x=null;switch(s[N]=y){case P:m=!0,p=function(n,e,t,r){var u=n[A]||{};if(n[E]===F)return document.createTextNode(H(u,w));var i=(e=e||"svg"===n[E])?document.createElementNS("http://www.w3.org/2000/svg",n[E]):document.createElement(n[E]);for(var o in u)q(i,o,u[o],null,e,t);return r.set(i,u),i}(c,f,r,u);break;case R:v=function(n,e,t,r){var u=n[j],i=n[A],o=H(n,O)||{},a=!1;if(n[E]===F)return(a=H(i,w)!=H(o,w))&&(u.nodeValue=H(i,w)),[u,a];for(var c in i)i[c]!==("value"===c||"checked"===c?u[c]:o[c])&&(q(u,c,i[c],o[c],e,t),a=!0);return r.set(u,i),[u,a]}(c,f,r,u),p=v[0],m=v[1];break;case C:m=!0,d==C&&e.push(function(){return p.parentElement&&p.parentElement.removeChild(p)});break;case L:m=!0,s[N]=M,x={done:function(){i.set(p,!0),Promise.resolve({}).then(n)}}}m&&p instanceof Element&&t.push(function(n,e,t){void 0===t&&(t={});var r=new CustomEvent(e,t);return function(){return n.dispatchEvent(r)}}(p,y.toLowerCase(),{detail:x}));var b=c[k].reduce(function(n,e){var t=a(e,f,y);return t?n.concat(t):n},[]);return y===C?null:(b.map(function(n){return n.element}).reduceRight(function(n,e){return p.insertBefore(e,n),e},null),s[k]=b,s[j]=p,s)}function y(n){return null!=n&&"object"==typeof n&&A in n&&k in n&&c in n&&E in n}function D(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];for(var u=[];t.length;){var i=t.pop();i&&Array.isArray(i)?t=t.concat(i):null!=i&&!0!==i&&!1!==i&&u.unshift(y(i)&&i||B(!0,i))}return B(!1,n,e||{},u)}function G(n,t,e,r){return e.reduce(function(n,e){return n.push.apply(n,t(e,r)),n},[])}function J(r,u){return function(n,t){return function(n,e){return function(n,e,t,r,u,i){if(!u)return[];if(D===u.name)return G(0,r,u[k],i);var o=u[A],a=i&&i[A]||{},c=H(o,m);if(!c){var f=H(a,m)||"",l=H(o,h);c=f&&l?f+"."+l:l||f}var v=n(c);v||e(v=S({},H(o,d)||{}),c);var s=V(o,v,S(S({},H(o,p)||{}),i&&H(i,A+"."+p)||{}),c);return("function"==typeof u.name?r(u.name(s,u[k]),u):[u]).reduce(function(n,e){return y(e)&&(e[k]=G(0,r,e[k],e),n.push(e)),n},[])}(r,u,0,t,n,e)}}}function K(t,r,l){var o,a,c,v=new WeakMap,s=new WeakMap,p=(o=t,a=r,c=v,function(n){var e=n.currentTarget,t=c.get(e),r=H(t,m),u=n.detail||{},i=t["on"+n.type](a(r),u,t,n);o(i,r)});return function(){var u,i,o,a,c,f,n=[],e=[];return[J(r,l),(u=t,i=n,o=e,a=p,c=v,f=s,function(n,r){return function(n,e,t){return g(u,i,o,a,c,f,0,r,n,e,t)}}),function(){return function(){e.reduceRight(function(n,e){return e()},0),n.reduceRight(function(n,e){return e()},0)}}]}}function Q(n,e,t){var r=V(n[A]),u=t.map(function(n){return n[0]}).reduce(f,[v,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return u.apply(null,n)}])[0],i=t.map(function(n){return n[1]}).reduce(f,[v,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return i.apply(null,n)}])[0],o=t.map(function(n){return n[2]}).reduce(f,[v,v])[0],a=function u(n,e){if(!e)return W(n);if(!n)return T(e,O,e[A]),e[N]=e[N]===M||e[N]===C?e[N]:H(e,A+".on"+L)?L:C,e;T(e,O,e[A]),e[A]=n[A],e[c]=n[c],e[E]=n[E],e[N]=R;var i=e[k].map(function(n,e){return n.i=e,n}),r=n[k].map(function(n){var e,t,r;for(r=0;r<i.length;r++)if(t=i[r],n[E]==t[E]&&n[c]==t[c]&&(R===t[N]||P===t[N])){e=t;break}return e?(i.splice(r,1),u(n,e)):u(n)});return i.map(function(n){if(0===(n=u(void 0,n)).i)r.unshift(n);else{var e=n.i-1,t=void 0;for(t=0;t<r.length;t++)if(e===r[t].i)return void r.splice(t+1,0,n);r.push(n)}}),e[k]=r,e}(u(D(e,r,[]))[0],n);return n=i(a,"svg"===a.name,""),o(),n}function f(n,e){var t=n[0],r=n[1];return[e?e(t,r):t,r]}function v(){}z[L]=1,z[M]=2,z[C]=3;var e=new WeakMap;n.atto=function(e,n,t){void 0===t&&(t={});var r,u,i,o,a,c=!1,f=n instanceof Element?((u=W(B(!1,(r=n).nodeName)))[j]=r,u):n,l=H(V(f[A]),x),v=b in t&&t[b]||[],s=(i=d,o=m,a=function(){c||(c=!0,Promise.resolve().then(h).then(g,y))},function(n,e){return I(i,o,a,n,e)}),p=[K].concat(v).map(function(n){return n(s,d,m,e,f)});function d(n,e){return void 0===e&&(e={}),(n?H(l,n):l)||e}function m(n,e){e?T(l,e,n):l=n}function h(){f=Q(f,e,p.map(function(n){return n()}))}function g(){c=!1}function y(n){throw g(),n}return s},n.currentOnlyEventHandler=function(r){return e.has(r)||e.set(r,function(n,e,t){if(t.currentTarget===t.target)return r(n,e,t)}),e.get(r)},n.x=D});
//# sourceMappingURL=xatto.min.js.map