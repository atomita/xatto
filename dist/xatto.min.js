!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(n.xatto={})}(this,function(n){"use strict";var k="xa.context",p="xa.extra",d="xa.fill",m="xa.path",h="xa.slice",y="xa.text",E="middlewares",A="children",f="key",g="name",j="props",N="node",x="lifecycle",b="prev."+j;function O(n,e){for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}var w="create",P="destroy",C="remove",R="update";function S(n,e,t,r){for(void 0===r&&(r=".");;){if("object"!=typeof n)return!1;var u=e.indexOf(r);if(u<0)return n[e]=t,!0;var i=e.slice(0,u),o=e.slice(u+1);if(null==n[i]){var c=o.split(r,1)[0];n[i]=c===""+parseInt(c,10)?[]:{}}n=n[i],e=o}}function T(n,e,t){var r=O({},n);return r.i=0,r[x]=w,r[A]=n[A].map(function(n){return t(w,n)}),S(r,b,{}),r}var F="xa-txt";function L(n,e,t,r){void 0===t&&(t={}),void 0===r&&(r=[]);var u={};return u[g]=e,u[j]=t,u[A]=r,u[f]=t.key,n&&"function"!=typeof e&&(u[g]=F,S(u[j],y,e)),u}function M(){}function W(n,e,t){for(void 0===t&&(t=".");;){if(null==n)return n;var r=e.indexOf(t);if(r<0)return n[e];n=n[e.slice(0,r)],e=e.slice(r+1)}}function B(e,t,r,n,u){if(n){if(n instanceof Promise)return n.then(function(n){return B(e,t,r,n,u)});if("function"==typeof n)return n(B,e);if("object"==typeof n){var i=e(u);if(n===i)return;var o=O(O({},i),n);t(o,u),r()}}}function I(n,e,t,r){return S(n,k,e||W(n,k)||{}),S(n,p,t||W(n,p)||{}),S(n,m,r||""),n}var l={};function V(n,e,u,t,r,i){if(!i)return T(r,0,u);if(!r){S(i,b,i[j]);var o=function(n,e,t,r){var u=l[n],i=l[e],o=i&&(!u||u<i)&&e||n;if(C!=o)return o;var c=t[N];return r.get(c)||C==n&&!W(t,j+".on"+C)?P:C}(C!=t&&P!=t?C:R,t,i,n);return i[x]=o,i[A]=i[A].map(function(n){return u(o,null,n)}),i}S(i,b,i[j]),i[j]=r[j],i[f]=r[f],i[g]=r[g],i[x]=R;var c=i[A].map(function(n,e){return n.i=e,n}),a=r[A].map(function(n){var e,t,r;for(r=0;r<c.length;r++)if(t=c[r],n[g]==t[g]&&n[f]==t[f]&&(R===t[x]||w===t[x])){e=t;break}return e?(c.splice(r,1),u(R,n,e)):u(R,n)});return c.map(function(n){if(0===(n=u(R,null,n)).i)a.unshift(n);else{var e=n.i-1,t=void 0;for(t=0;t<a.length;t++)if(e===a[t].i)return void a.splice(t+1,0,n);a.push(n)}}),i[A]=a,i}l[C]=1,l[P]=2;var v="http://www.w3.org/1999/xlink";function q(n,e,t,r,u,i){if("o"===e[0]&&"n"===e[1]){var o=e.slice(2);t instanceof Function?r instanceof Function||n.addEventListener(o,i):n.removeEventListener(o,i)}else{var c=null==t||!1===t;if(e in n&&"list"!==e&&"draggable"!==e&&"spellcheck"!==e&&"translate"!==e&&!u)c?n.removeAttribute(e):n[e]=null==t?"":t;else{var a=!1;if(u){var f=e;a=(e=e.replace(/^xlink:?/,""))!==f}switch((c?1:0)+((a?1:0)<<1)){case 0:n.setAttribute(e,t);break;case 1:n.removeAttribute(e);break;case 2:n.setAttributeNS(v,e,t);break;case 3:n.removeAttributeNS(v,e)}}}}function z(n,e,t,r,u,i,o,c,a,f){var l,v=O({},a),s=a[N];f||"svg"!==a[g]||(f=!0);var p,d=v[x],m=null;switch(d){case w:p=!0,s=function(n,e,t,r){var u=n[j]||{};if(n[g]===F)return document.createTextNode(W(u,y));var i=(e=e||"svg"===n[g])?document.createElementNS("http://www.w3.org/2000/svg",n[g]):document.createElement(n[g]);for(var o in u)"object"!=typeof u[o]&&q(i,o,u[o],null,e,t);return r.set(i,u),i}(a,f,r,u);break;case R:l=function(n,e,t,r){var u=n[N],i=n[j],o=W(n,b)||{},c=!1;if(n[g]===F)return(c=W(i,y)!=W(o,y))&&(u.nodeValue=W(i,y)),[u,c];for(var a in i)"object"!=typeof i[a]&&i[a]!==("value"===a||"checked"===a?u[a]:o[a])&&(q(u,a,i[a],o[a],e,t),c=!0);return r.set(u,i),[u,c]}(a,f,r,u),s=l[0],p=l[1];break;case P:p=!0,e.push(function(){var n=s.parentElement||s.parentNode;n&&n.removeChild(s)});break;case C:i.has(s)||(i.set(s,!1),p=!0,m={done:function(){i.set(s,!0),Promise.resolve({}).then(n)}})}p&&t.push(function(e,n,t){void 0===t&&(t={});var r=[new CustomEvent("lifecycle",{detail:O({type:n},t)}),new CustomEvent(n,{detail:t})];return function(){return r.map(function(n){return e.dispatchEvent(n)})}}(s,d,m));var h=a[A].reduce(function(n,e){var t=c(e,f);return t?n.concat(t):n},[]);return d===P?null:(h.map(function(n){return n[N]}).reduceRight(function(n,e){return s.insertBefore(e,n),e},null),v[A]=h,v[N]=s,v)}function D(n){return null!=n&&"object"==typeof n&&j in n&&A in n&&f in n&&g in n}function G(n,e){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];for(var u=[];t.length;){var i=t.pop();i&&Array.isArray(i)?t=t.concat(i):null!=i&&!0!==i&&!1!==i&&u.unshift(D(i)&&i||L(!0,i))}return L(!1,n,e||{},u)}function H(n,t,e,r){return e.reduce(function(n,e){return n.push.apply(n,t(e,r)),n},[])}function J(r,u){return function(n,t){return function(n,e){return function(n,e,t,r,u,i){if(!u)return[];if(G===u.name)return H(0,r,u[A],i);var o=u[j],c=i&&i[j]||{},a=W(o,m);if(!a){var f=W(c,m)||"",l=W(o,h);null!=l&&(l=""+l),a=f&&l?f+"."+l:l||f}var v=n(a);v||e(v=O({},W(o,d)||{}),a);var s=I(o,v,O(O({},W(o,p)||{}),i&&W(i,j+"."+p)||{}),a);return("function"==typeof u.name?r(u.name(s,u[A]),u):[u]).reduce(function(n,e){return D(e)&&(e[A]=H(0,r,e[A],e),n.push(e)),n},[])}(r,u,0,t,n,e)}}}function K(t,l,v){var o,c,a,s=new WeakMap,p=new WeakMap,d=(o=t,c=l,a=s,function(n){var e=n.currentTarget,t=a.get(e)||{},r=W(t,m)||"",u=n.detail||{},i=t["on"+n.type](c(r),u,t,n);o(i,r)});return function(){var r,u,i,o,c,a,f,n=[],e=[];return[J(l,v),(f=p,function(n,r){return function(n,e,t){return V(f,0,r,n,e,t)}}),(r=t,u=n,i=e,o=d,c=s,a=p,function(n,t){return function(n,e){return z(r,u,i,o,c,a,0,t,n,e)}}),function(){return function(){e.reduceRight(function(n,e){return e()},0),n.reduceRight(function(n,e){return e()},0)}}]}}function Q(n,e){var t=n[0],r=n[1];return[e?e(t,r):t,r]}n.atto=function(e,n,t){void 0===t&&(t={});var r,u,i,o,c,a=!1,f=!1,l=!1,v=n instanceof Element?((u=T(L(!1,(r=n).nodeName),0,M))[N]=r,u):n,s=W(I(v[j]),k),p=E in t&&t[E]||[],d=(i=h,o=y,c=w,function(n,e){return void 0===e&&(e=""),B(i,o,c,n,e)}),m=[K].concat(p).map(function(n){return n(d,h,y,e,v)});function h(n,e){return void 0===e&&(e={}),(n?W(s,n):s)||e}function y(n,e){e?S(s,e,n):s=n}function g(){try{f=!0,v=function(n,e,t){var r=t.map(function(n){return n[0]}).reduce(Q,[M,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return r.apply(null,n)}])[0],u=t.map(function(n){return n[1]}).reduce(Q,[M,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return u.apply(null,n)}])[0],i=t.map(function(n){return n[2]}).reduce(Q,[M,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return i.apply(null,n)}])[0],o=t.map(function(n){return n[3]}).reduce(Q,[M,M])[0],c=r(G(e,{},[])),a=O({},n);a[A]=c;var f=u(R,a,n);return n=i(f,"svg"===f.name),o(),n}(v,e,m.map(function(n){return n()}))}finally{f=!1}}function x(){a=!1,l&&(l=!1,w())}function b(n){throw x(),n}function w(){a?f&&(l=!0):(a=!0,Promise.resolve().then(g).then(x,b))}return d},n.currentOnly=function(u){return function(n,e,t,r){if(r.currentTarget===r.target)return u(n,e,t,r)}},n.x=G});
//# sourceMappingURL=xatto.min.js.map