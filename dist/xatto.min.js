!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.xatto={})}(this,function(e){"use strict";var b="attributes",j="children",f="key",O="name",k="xa.context",w="xa.extra",u="xa.slice",N="xa.text",A="xa-context",E="xa-extra",c="xa-slice";function P(e,n,t){for(void 0===t&&(t=".");;){if(null==e)return e;var r=n.indexOf(t);if(r<0)return e[n];e=e[n.slice(0,r)],n=n.slice(r+1)}}function d(e,n,t,r){for(void 0===r&&(r=".");;){if("object"!=typeof e)return!1;var o=n.indexOf(r);if(o<0)return e[n]=t,!0;var i=n.slice(0,o),a=n.slice(o+1);if(null==e[i]){var f=a.split(r,1)[0];e[i]=f===""+parseInt(f,10)?[]:{}}e=e[i],n=a}}var B="xa-txt",C=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e};function L(e,n){var t=e&&e[b];if(t){var r=P(t,k)||t[A]||n&&(P(n,b+"."+k)||P(n,b+"."+A))||{},o=P(t,u)||t[c],i=void 0;"object"!=typeof o&&(o=[o]);var a=o[0];if(a){if(!(i=P(r,a))){var f=o[1]||{};d(r,a,i=C({},f))}r=i}var l=C({},P(t,w)||t[E]||{},n&&(P(n,b+"."+w)||P(n,b+"."+E))||{});d(t,k,r),d(t,w,l),t[A]=r,t[E]=l}return e&&"function"==typeof e.name?L(e.name(e[b],e[j]),e):null!=e?e:""}function T(e,n,t,r,o,i){"key"===n||"object"==typeof t||("o"===n[0]&&"n"===n[1]?(e.events||(e.events={}),(e.events[n=n.slice(2)]=t)?r||e.addEventListener(n,i):e.removeEventListener(n,i)):n in e&&"list"!==n&&!o?e[n]=null==t?"":t:null!=t&&!1!==t&&e.setAttribute(n,t),null!=t&&!1!==t||e.removeAttribute(n))}function I(e){return e?e.key:null}function S(e,n,t){function r(){e.removeChild(function e(n,t){var r=t[b];if(r){for(var o=0;o<t[j].length;o++)e(n.childNodes[o],t[j][o]);r.ondestroy&&r.ondestroy(n,r)}return n}(n,t))}var o=t[b]||{},i=o.onremove;i?i(n,r,o):r()}function V(e,n,t,r,o,i,a){if(void 0===i&&(i=!1),r===t);else if(null==t||t.name!==r.name){var f=function e(n,t,r,o){var i=n[b],a=n[O]===B,f=a?document.createTextNode(P(i,N)):(r=r||"svg"===n[O])?document.createElementNS("http://www.w3.org/2000/svg",n[O]):document.createElement(n[O]);if(i){var l=i.oncreate;if(l&&t.push(function(){l(f,{},P(i,k)||i[A],P(i,w)||i[E])}),a);else{for(var u=0;u<n[j].length;u++)f.appendChild(e(n[j][u]=L(n[j][u],n),t,r,o));for(var c in i)T(f,c,i[c],null,r,o)}f.context=P(i,k)||i[k],f.extra=P(i,w)||i[w]}return f}(r,o,i,a);e.insertBefore(f,n),null!=t&&S(e,n,t),n=f}else if(t.name===B)n.nodeValue=P(r[b],N);else{!function(e,n,t,r,o,i){var a=C({},n,t);for(var f in a)t[f]!==("value"===f||"checked"===f?e[f]:n[f])&&T(e,f,t[f],n[f],o,i);e.context=P(t,k)||t[A],e.extra=P(t,w)||t[E];var l=e.recycle?t.oncreate:t.onupdate;e.recycle=!1,l&&r.push(function(){l(e,n,t)})}(n,t[b],r[b],o,i=i||"svg"===r.name,a);for(var l={},u={},c=[],v=t[j],s=r[j],d=0;d<v.length;d++){c[d]=n.childNodes[d],null!=(h=I(v[d]))&&(l[h]=[c[d],v[d]])}for(var x=0,p=0;p<s.length;){var h=I(v[x]),y=I(s[p]=L(s[p],r));if(u[h])x++;else if(null==y||y!==I(v[x+1]))if(null==y||!0===n.recycle)null==h&&(V(n,c[x],v[x],s[p],o,i,a),p++),x++;else{var m=l[y]||[];h===y?(V(n,m[0],m[1],s[p],o,i,a),x++):m[0]?V(n,n.insertBefore(m[0],c[x]),m[1],s[p],o,i,a):V(n,c[x],null,s[p],o,i,a),u[y]=s[p],p++}else null==h&&S(n,c[x],v[x]),x++}for(;x<v.length;)null==I(v[x])&&S(n,c[x],v[x]),x++;for(var g in l)u[g]||S(n,l[g][0],l[g][1])}return n}function l(e,n,t,r){void 0===t&&(t={}),void 0===r&&(r=[]);var o={};return o[O]=n,o[b]=t,o[j]=r,o[f]=t.key,e&&"function"!=typeof n&&(o[O]=B,d(o[b],N,n)),o}function x(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];for(var o,i=[];t.length;){var a=t.pop();a&&Array.isArray(a)?t=t.concat(a):null!=a&&!0!==a&&!1!==a&&i.unshift("object"==typeof(o=a)&&b in o&&j in o&&f in o&&O in o&&4===Object.keys(o).length&&a||l(!0,a))}return l(!1,e,n||{},i)}e.atto=function(t,r,o){void 0===o&&(o=null);var i=!1,a=o&&o[b]||{},f=P(a,k)||a[A]||{};function l(e,n,t){if(void 0===n&&(n=f),void 0===t&&(t=null),e&&e!==n)if(e instanceof Promise)e.then(function(e){return l(e,n,t)});else if("object"==typeof e){null==t&&"string"==typeof n&&(t=n,n=f);var r=t?P(n,t)||{}:n;Object.entries(e).map(function(e){var n=e[0],t=e[1];return r[n]=t}),t&&d(n,t,r)}i||(i=!0,Promise.resolve().then(c).then(v,s))}function u(e){var n=e.currentTarget;n.context=n.context||{},n.extra=n.extra||{},l(n.events[e.type](e,n.context,n.extra),n.context)}function c(){var e=[],n=L(x(t,a,o&&o[j]),x("div",{},[]));for(r=V(r.parentNode,r,o,o=n,e,"svg"===n.name,u);e.length;)e.pop()()}function v(){i=!1}function s(e){throw v(),e}return d(a,k,f),a[A]=f,l},e.x=x});
//# sourceMappingURL=dist/xatto.min.js.map