!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.xatto={})}(this,function(e){"use strict";var m="children",h="key",y="name",b="props",g="xa.context",x="xa.extra",f="xa.slice",a="xa.text",k="element",w="lifecycle",j="prev."+b,l=function(){return(l=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var u in n=arguments[t])Object.prototype.hasOwnProperty.call(n,u)&&(e[u]=n[u]);return e}).apply(this,arguments)},A="create",O="destroy",E="remove",N="removing",P="update";function S(e,n,t,r){for(void 0===r&&(r=".");;){if("object"!=typeof e)return!1;var u=n.indexOf(r);if(u<0)return e[n]=t,!0;var i=n.slice(0,u),o=n.slice(u+1);if(null==e[i]){var c=o.split(r,1)[0];e[i]=c===""+parseInt(c,10)?[]:{}}e=e[i],n=o}}function L(e){var n=l({},e);return n.i=0,n[w]=A,n[m]=e[m].map(function(e){return L(e)}),S(n,j,{}),n}var s="xa-txt";function R(e,n,t,r){void 0===t&&(t={}),void 0===r&&(r=[]);var u={};return u[y]=n,u[b]=t,u[m]=r,u[h]=t.key,e&&"function"!=typeof n&&(u[y]=s,S(u[b],a,n)),u}function T(e,n,t){for(void 0===t&&(t=".");;){if(null==e)return e;var r=n.indexOf(t);if(r<0)return e[n];e=e[n.slice(0,r)],n=n.slice(r+1)}}var B=function(e){return b+".on"+e};var v="http://www.w3.org/1999/xlink";function p(e,n,t,r,u,i,o){if("key"===n||"object"==typeof t);else if("o"===n[0]&&"n"===n[1]){var c=n.slice(2);null==t?e.removeEventListener(c,i):null==r&&e.addEventListener(c,i)}else{var a=null==t||!1===t;if(n in e&&"list"!==n&&"draggable"!==n&&"spellcheck"!==n&&"translate"!==n&&!u)a?e.removeAttribute(n):e[n]=null==t?"":t;else{var f=!1;if(u){var l=n;f=(n=n.replace(/^xlink:?/,""))!==l}switch((a?1:0)+((f?1:0)<<1)){case 0:e.setAttribute(n,t);break;case 1:e.removeAttribute(n);break;case 2:e.setAttributeNS(v,n,t);break;case 3:e.removeAttributeNS(v,n)}}}}function C(u,i){return function(){for(var e,n,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e=u,n=i.concat(t),e.apply(null,n)}}function I(r,e,u,i,o,c){var t;u||"svg"!==e[y]||(u=!0),c||e[w]!==O||(c=!0);var n=e[m].reduce(function(e,n){var t=r(n,u,i,o,c);return t?e.concat(t):e},[]);switch(c?O:e[w]){case A:t=function(e,n,t,r){var u=e[b]||{};if(e[y]===s)return document.createTextNode(T(u,a));var i=(n=n||"svg"===e[y])?document.createElementNS("http://www.w3.org/2000/svg",e[y]):document.createElement(e[y]);for(var o in u)p(i,o,u[o],null,n,t);return r.set(i,u),i}(e,u,i,o);break;case P:t=function(e,n,t,r){var u=e[k],i=e[b];if(e[y]===s)return u.nodeValue=T(i,a),u;var o=T(e,j)||{};for(var c in i)i[c]!==("value"===c||"checked"===c?u[c]:o[c])&&p(u,c,i[c],o[c],n,t);return r.set(u,i),u}(e,u,i,o);break;case O:return e[w]===O&&(t=e[k]).parentElement.removeChild(t),null;case E:e[w]=N;default:t=e[k]}return n.map(function(e){return e.element}).reduceRight(function(e,n){return t.insertBefore(n,e),n},null),e[m]=n,e[k]=t,e}function M(e,n,t,r,u,i,o,c){var a;switch(c?O:r[w]){case A:a=T(r,B(A));break;case P:a=T(r,B(P));break;case E:var f=T(r,B(E)),l=function(){r[w]=O,Promise.resolve().then(n)};a=function(e,n,t){f(e,l,n,t)};break;case O:a=T(r,B(O))}return a&&e.push(function(){a(r[k],r[b],T(r,j))}),t(r,u,i,o,c)}function V(e,n,t,r){return S(e,g,n||T(e,g)||{}),S(e,x,t||T(e,x)||{}),S(e,f,r||T(e,f)||[]),e}function d(e){return null!=e&&"object"==typeof e&&b in e&&m in e&&h in e&&y in e&&4===Object.keys(e).length}function W(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];for(var u=[];t.length;){var i=t.pop();i&&Array.isArray(i)?t=t.concat(i):null!=i&&!0!==i&&!1!==i&&u.unshift(d(i)&&i||R(!0,i))}return R(!1,e,n||{},u)}function q(e,t){return e.reduce(function(e,n){return e.push.apply(e,z(n,t)),e},[])}function z(e,n){if(!e)return[];if(W===e.name)return q(e[m],n);var t,r=e[b],u=T(r,g)||n&&T(n,b+"."+g)||{},i=T(r,f);"object"!=typeof i&&(i=[i]);var o=i[0];if(o){if(!(t=T(u,o))){var c=i[1]||{};S(u,o,t=l({},c))}u=t}var a=V(r,u,l({},T(r,x)||{},n&&T(n,b+"."+x)||{}),[]);return("function"==typeof e.name?z(e.name(a,e[m]),e):[e]).reduce(function(e,n){return d(n)&&(n[m]=q(n[m],n),e.push(n)),e},[])}e.atto=function(i,e){var n,t,u=!1,o=e instanceof Element?((t=L(R(!1,(n=e).nodeName)))[k]=n,t):e,c=V(o[b]),a=T(c,g),f=new WeakMap;function l(e,n,t){if(void 0===e&&(e=null),void 0===n&&(n=a),void 0===t&&(t=null),e&&e!==n){if("function"==typeof e)return e(l,n,a);if(e instanceof Promise)return e.then(function(e){return l(e,n,t)});if("object"==typeof e){null==t&&"string"==typeof n&&(t=n,n=a);var r=t?T(n,t)||{}:n;Object.entries(e).map(function(e){var n=e[0],t=e[1];return r[n]=t}),t&&S(n,t,r)}}u||(u=!0,Promise.resolve().then(v).then(p,d))}function s(e){var n=e.currentTarget,t=f.get(n),r=T(t,g),u=T(t,x);l(t["on"+e.type](e,r,u),r)}function v(){var n,t,e=function u(e,n){if(!n)return L(e);if(!e)return S(n,j,n[b]),n[w]=n[w]===N||n[w]===O?n[w]:T(n,B(E))?E:O,n;S(n,j,n[b]),n[b]=e[b],n[h]=e[h],n[y]=e[y],n[w]=P;var i=n[m].map(function(e,n){return e.i=n,e}),o=e[m].map(function(e){var n,t,r;for(r=0;r<i.length;r++)if(t=i[r],e[y]==t[y]&&e[h]==t[h]&&(P===t[w]||A===t[w])){n=t;break}return n?(i.splice(r,1),u(e,n)):u(e)});return i.reduceRight(function(e,n){if(0===(n=u(void 0,n)).i)o.unshift(n);else{var t=n.i-1,r=void 0;for(r=0;r<o.length;r++)if(t===o[r].i)return o.splice(r+1,0,n),0;o.push(n)}return 0},0),n[m]=o,n}(z(W(i,c,o[m]))[0],o),r=[[function(e){return C(I,[e])}],(n=l,t=[],[function(e){return C(M,[t,n,e])},function(){return t.reduce(function(e,n){return n()},0)}])],u=r.map(function(e){return e[0]}).reduce(function(e,n){return n(e)},function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return u.apply(null,e)});o=u(e,"svg"===e.name,s,f,!1),r.map(function(e){return e[1]&&e[1]()})}function p(){u=!1}function d(e){throw p(),e}return l},e.x=W});
//# sourceMappingURL=dist/xatto.min.js.map