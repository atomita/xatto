!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(n.xatto={})}(this,function(n){"use strict";var x="xa.context",p="xa.extra",d="xa.fill",m="xa.path",h="xa.slice",w="xa.text",b="middlewares",k="children",a="key",E="name",A="props",j="element",N="lifecycle",O="prev."+A,P="create",C="destroy",L="remove",R="removing",S="update";function T(n,e){for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return n}function M(n,e,r,t){for(void 0===t&&(t=".");;){if("object"!=typeof n)return!1;var u=e.indexOf(t);if(u<0)return n[e]=r,!0;var i=e.slice(0,u),o=e.slice(u+1);if(null==n[i]){var c=o.split(t,1)[0];n[i]=c===""+parseInt(c,10)?[]:{}}n=n[i],e=o}}function W(n){var e=T({},n);return e.i=0,e[N]=P,e[k]=n[k].map(function(n){return W(n)}),M(e,O,{}),e}var B="xa-txt";function H(n,e,r,t){void 0===r&&(r={}),void 0===t&&(t=[]);var u={};return u[E]=e,u[A]=r,u[k]=t,u[a]=r.key,n&&"function"!=typeof e&&(u[E]=B,M(u[A],w,e)),u}function I(n,e,r){for(void 0===r&&(r=".");;){if(null==n)return n;var t=e.indexOf(r);if(t<0)return n[e];n=n[e.slice(0,t)],e=e.slice(t+1)}}function V(e,r,n,t,u){if(void 0===u&&(u=""),t){if(t instanceof Promise)return t.then(function(n){return V(e,r,n,u)});if("function"==typeof t)return t(V,e);if("object"==typeof t){var i=e(u);if(t===i)return;var o=T(T({},i),t);r(o,u),n()}}}function q(n,e,r,t){return M(n,x,e||I(n,x)||{}),M(n,p,r||I(n,p)||{}),M(n,m,t||""),n}var l="http://www.w3.org/1999/xlink";function z(n,e,r,t,u,i){if("object"==typeof r);else if("o"===e[0]&&"n"===e[1]){var o=e.slice(2);null==r?n.removeEventListener(o,i):null==t&&n.addEventListener(o,i)}else{var c=null==r||!1===r;if(e in n&&"list"!==e&&"draggable"!==e&&"spellcheck"!==e&&"translate"!==e&&!u)c?n.removeAttribute(e):n[e]=null==r?"":r;else{var a=!1;if(u){var f=e;a=(e=e.replace(/^xlink:?/,""))!==f}switch((c?1:0)+((a?1:0)<<1)){case 0:n.setAttribute(e,r);break;case 1:n.removeAttribute(e);break;case 2:n.setAttributeNS(l,e,r);break;case 3:n.removeAttributeNS(l,e)}}}}var D={};function g(n,e,r,t,u,i,o,c,a,f,l){var v,s=T({},a),p=a[j];f||"svg"!==a[E]||(f=!0);var d=a[N];d===R&&p instanceof Element&&i.has(p)&&(d=C);var m,h=D[d],g=D[l],y=g&&(!h||h<g)&&l||d,x=null;switch(s[N]=y){case P:m=!0,p=function(n,e,r,t){var u=n[A]||{};if(n[E]===B)return document.createTextNode(I(u,w));var i=(e=e||"svg"===n[E])?document.createElementNS("http://www.w3.org/2000/svg",n[E]):document.createElement(n[E]);for(var o in u)z(i,o,u[o],null,e,r);return t.set(i,u),i}(a,f,t,u);break;case S:v=function(n,e,r,t){var u=n[j],i=n[A],o=I(n,O)||{},c=!1;if(n[E]===B)return(c=I(i,w)!=I(o,w))&&(u.nodeValue=I(i,w)),[u,c];for(var a in i)i[a]!==("value"===a||"checked"===a?u[a]:o[a])&&(z(u,a,i[a],o[a],e,r),c=!0);return t.set(u,i),[u,c]}(a,f,t,u),p=v[0],m=v[1];break;case C:m=!0,e.push(function(){return p.parentElement.removeChild(p)});break;case L:m=!0,s[N]=R,x={done:function(){i.set(p,!0),Promise.resolve({}).then(n)}}}m&&p instanceof Element&&r.push(function(n,e,r){void 0===r&&(r={});var t=new CustomEvent(e,r);return function(){return n.dispatchEvent(t)}}(p,y.toLowerCase(),{detail:x}));var b=a[k].reduce(function(n,e){var r=c(e,f,y);return r?n.concat(r):n},[]);return y===C?null:(b.map(function(n){return n.element}).reduceRight(function(n,e){return p.insertBefore(e,n),e},null),s[k]=b,s[j]=p,s)}function y(n){return null!=n&&"object"==typeof n&&A in n&&k in n&&a in n&&E in n}function F(n,e){for(var r=[],t=2;t<arguments.length;t++)r[t-2]=arguments[t];for(var u=[];r.length;){var i=r.pop();i&&Array.isArray(i)?r=r.concat(i):null!=i&&!0!==i&&!1!==i&&u.unshift(y(i)&&i||H(!0,i))}return H(!1,n,e||{},u)}function G(n,r,e,t){return e.reduce(function(n,e){return n.push.apply(n,r(e,t)),n},[])}function J(t,u){return function(n,r){return function(n,e){return function(n,e,r,t,u,i){if(!u)return[];if(F===u.name)return G(0,t,u[k],i);var o=u[A],c=i&&i[A]||{},a=I(o,m);if(!a){var f=I(c,m)||"",l=I(o,h);a=f&&l?f+"."+l:l||f}var v=n(a);v||e(v=T({},I(o,d)||{}),a);var s=q(o,v,T(T({},I(o,p)||{}),i&&I(i,A+"."+p)||{}),a);return("function"==typeof u.name?t(u.name(s,u[k]),u):[u]).reduce(function(n,e){return y(e)&&(e[k]=G(0,t,e[k],e),n.push(e)),n},[])}(t,u,0,r,n,e)}}}function K(r,t,l){var i,o,c,v=new WeakMap,s=new WeakMap,p=(i=r,o=t,c=v,function(n){var e=n.currentTarget,r=c.get(e),t=I(r,m),u=r["on"+n.type](o(t),r,n);i(u,t)});return function(){var u,i,o,c,a,f,n=[],e=[];return[J(t,l),(u=r,i=n,o=e,c=p,a=v,f=s,function(n,t){return function(n,e,r){return g(u,i,o,c,a,f,0,t,n,e,r)}}),function(){return function(){e.reduceRight(function(n,e){return e()},0),n.reduceRight(function(n,e){return e()},0)}}]}}D[L]=1,D[R]=2,D[C]=3;var f=function(n){return A+".on"+n};function Q(n,e,r){var t=q(n[A]),u=r.map(function(n){return n[0]}).reduce(v,[s,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return u.apply(null,n)}])[0],i=r.map(function(n){return n[1]}).reduce(v,[s,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return i.apply(null,n)}])[0],o=r.map(function(n){return n[2]}).reduce(v,[s,s])[0],c=function u(n,e){if(!e)return W(n);if(!n)return M(e,O,e[A]),e[N]=e[N]===R||e[N]===C?e[N]:I(e,f(L))?L:C,e;M(e,O,e[A]),e[A]=n[A],e[a]=n[a],e[E]=n[E],e[N]=S;var i=e[k].map(function(n,e){return n.i=e,n}),t=n[k].map(function(n){var e,r,t;for(t=0;t<i.length;t++)if(r=i[t],n[E]==r[E]&&n[a]==r[a]&&(S===r[N]||P===r[N])){e=r;break}return e?(i.splice(t,1),u(n,e)):u(n)});return i.map(function(n){if(0===(n=u(void 0,n)).i)t.unshift(n);else{var e=n.i-1,r=void 0;for(r=0;r<t.length;r++)if(e===t[r].i)return void t.splice(r+1,0,n);t.push(n)}}),e[k]=t,e}(u(F(e,t,[]))[0],n);return n=i(c,"svg"===c.name,""),o(),n}function v(n,e){var r=n[0],t=n[1];return[e?e(r,t):r,t]}function s(){}n.atto=function(e,n,r){void 0===r&&(r={});var t,u,i,o,c,a=!1,f=n instanceof Element?((u=W(H(!1,(t=n).nodeName)))[j]=t,u):n,l=I(q(f[A]),x),v=b in r&&r[b]||[],s=(i=d,o=m,c=function(){a||(a=!0,Promise.resolve().then(h).then(g,y))},function(n,e){return V(i,o,c,n,e)}),p=[K].concat(v).map(function(n){return n(s,d,m,e,f)});function d(n,e){return void 0===e&&(e={}),(n?I(l,n):l)||e}function m(n,e){e?M(l,e,n):l=n}function h(){f=Q(f,e,p.map(function(n){return n()}))}function g(){a=!1}function y(n){throw g(),n}return s},n.currentOnlyEventHandler=function(t){return function(n,e,r){if(r.currentTarget===r.target)return t(n,e,r)}},n.x=F});
//# sourceMappingURL=xatto.min.js.map